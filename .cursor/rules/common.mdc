---
description: 
globs: 
alwaysApply: true
---

# Markdown結合ルール

このルールは、Markdownファイルを結合してMDCファイルとして出力する際の基本的な処理方法を定義します。 

## ファイル探索ルール

Markdownファイルの探索は以下のルールに従って行われます：

1. 指定されたディレクトリ内のすべてのファイルとフォルダを再帰的に探索します
2. `.md`拡張子を持つファイルのみを処理対象とします
3. サブディレクトリも含めて探索を行います
4. 実行時には指定されたフォルダ階層の構造が維持されます 

## ディレクトリ処理ルール

ディレクトリの処理は以下のルールに従って行われます：

1. `rules`フォルダ直下のサブディレクトリごとにMDCファイルが生成されます
2. 先頭に`@`がついているフォルダは処理から除外されます。
3. 出力先のディレクトリ（`.cursor/rules/`）が存在しない場合は自動的に作成されます
4. 各サブディレクトリごとに並行処理が行われ、効率的にファイルが生成されます

## ファイル結合ルール

Markdownファイルの結合は以下のルールに従って行われます：

1. 同一ディレクトリ内のMarkdownファイルはアルファベット順（自然順）にソートされます
2. ファイル内容が結合される際には、ファイル間に適切な改行が挿入されます
3. 空のファイルは結合対象から除外されます
4. 処理中に読み取りエラーが発生した時点で処理を終了します

## 見出し書式ルール

見出しの書式は以下のルールに従って処理されます：

1. 見出し1（`# `で始まる行）と見出し2（`## `で始まる行）の間には、常に1行の空行が挿入されます
2. 見出し1の後に内容がある場合は、内容の後に1行の空行を挿入してから見出し2を配置します
3. 見出し1と見出し2の間に内容がない場合は、その間に1行の空行のみを挿入します
4. この書式ルールは、結合されたMDCファイル内のすべての見出しに適用されます 

## 出力ルール

MDCファイルの出力は以下のルールに従って行われます：

1. 出力ファイル名はソースディレクトリ名と同じ名前に`.mdc`拡張子を付けたものになります
2. 出力先は`.cursor/rules/`ディレクトリです
3. 既存のファイルがある場合は上書きされます
4. Markdownファイルが存在しないディレクトリに対してはMDCファイルは生成されません
5. 処理結果はコンソールに出力され、どのMDCファイルが生成されたかを確認できます 

## MDCファイル更新ルール

1. 既存のMDCファイルがある場合は上書き更新されます。ファイルの内容はクリアされずに、YAMLフロントマター（`---`で囲まれた部分）が保持されます。
2. Markdownファイルの内容からMDCファイルを生成する際、既存のMDCファイルのYAMLフロントマターは維持され、それ以外の部分だけが更新されます。
3. 既存のMDCファイルにYAMLフロントマターが存在しない場合は、通常通り新しい内容のみで更新されます。
4. Markdownファイルが存在しないディレクトリに対してはMDCファイルは生成されません。 